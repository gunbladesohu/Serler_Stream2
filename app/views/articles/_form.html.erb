<%= form_for(@article) do |f| %>
  <% if @article.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@article.errors.count, "error") %> prohibited this article from being saved:</h2>

      <ul>
      <% @article.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <label><%= f.label :research_questions %></label>
  <%= f.text_field :research_questions %><br>
  <label><%= f.label :research_metrics %></label>
  <%= f.text_field :research_metrics %><br>

  <div class="field">
    <legend>Research Method</legend>
    <% @research_methods.each do |research_method| %>
      <div class="checkbox">
        <label>
          <% @is_check = false %>
          <% @article.research_methods.each do |article_research_method| %>
            <% if article_research_method.name == research_method.name%>
              <% @is_check = true%>
              <% break %>
            <% end %> 
          <% end %>
          <%= check_box_tag 'article[research_method_ids][]', research_method.id, @is_check%>
          <%= research_method.name %>
        </label>
      </div>
    <% end %>
    <legend>Research Participant</legend>
    <% @research_participants.each do |research_participant| %>
      <div class="checkbox">
        <label>
          <% @is_check = false %>
          <% @article.research_participants.each do |article_research_participant| %>
            <% if article_research_participant.name == research_participant.name%>
              <% @is_check = true%>
              <% break %>
            <% end %>
          <% end %>
          <%= check_box_tag 'article[research_participant_ids][]', research_participant.id, @is_check%>
          <%= research_participant.name %>
        </label>
      </div>
    <% end %>
    <legend>Method</legend>
    <% @dev_methods.each do |dev_method| %>
      <div class="checkbox">
        <label>
          <% @is_check = false %>
          <% @article.dev_methods.each do |article_dev_method| %>
            <% if article_dev_method.name == dev_method.name%>
              <% @is_check = true%>
              <% break %>
            <% end %>
          <% end %>
          <%= check_box_tag 'article[dev_method_ids][]', dev_method.id, @is_check%>
          <%= dev_method.name %>
        </label>
      </div>
    <% end %>
    
    <legend>Methodology</legend>
    <% @methodologies.each do |methodology| %>
      <div class="checkbox">
        <label>
          <% @is_check = false %>
          <% @article.methodologies.each do |article_methodology| %>
            <% if article_methodology.name == methodology.name%>
              <% @is_check = true%>
              <% break %>
            <% end %>
          <% end %>
          <%= check_box_tag 'article[methodology_ids][]', methodology.id, @is_check%>
          <%= methodology.name %>
        </label>
      </div>
    <% end %>


  </div>


  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
